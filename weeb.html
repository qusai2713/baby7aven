<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>صفحة المنتج + لوحة التحكم</title>
<style>
body{font-family:Arial,sans-serif;background:#f0f2f5;margin:0;padding:20px}h2{text-align:center;color:#333}h3{color:#333}.options-title{text-align:right;margin-right:0;margin-left:0;font-size:20px}.container{max-width:700px;margin:20px auto;background:#fff;padding:20px 30px;border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,0.1)}.product{display:flex;flex-direction:column;align-items:center;margin-bottom:20px}.product img{width:180px;height:180px;object-fit:cover;border-radius:12px;margin-bottom:15px}.price{color:#d35400;font-size:24px;margin:10px 0;font-weight:bold}.stock{color:#27ae60;font-size:16px;margin:5px 0}.description{text-align:center;color:#555;font-size:16px;margin:10px 15px 20px 15px}.option-btn{background:#eee;margin:5px;padding:10px 20px;border-radius:25px;cursor:pointer;display:inline-block;transition:all 0.3s}.option-btn.active{background:#d35400;color:white}.option-btn:hover{transform:scale(1.05)}.add-to-cart{background:#ff7f00;color:white;font-size:18px;padding:12px 25px;border-radius:10px;transition:all 0.3s}.add-to-cart:hover{background:#e06a00}.admin-section input[type="text"],.admin-section input[type="file"]{padding:10px;margin:5px 0 15px 0;width:100%;font-size:16px;border-radius:8px;border:1px solid #ccc}.option-item{border:1px solid #ccc;padding:15px;margin-bottom:15px;border-radius:12px;background:#fafafa}.option-item button{background:#e74c3c;color:white;padding:8px 15px;border-radius:8px;margin-top:10px}.option-item button:hover{background:#c0392b}.admin-section button{background:#3498db;color:white;padding:12px 25px;border-radius:10px;font-size:16px;margin-top:10px}.admin-section button:hover{background:#2980b9}
</style>
</head>
<body>

<div class="container" id="mainPage">
<h2 id="productName"></h2>
<div class="product">
<img id="productImg" src="" alt="صورة المنتج">
<p class="price" id="productPrice"></p>
<p class="stock" id="productStock"></p>
<p class="description" id="productDesc"></p>
</div>

<h3 class="options-title">الأغراض</h3>
<div id="optionsContainer"></div>
<button class="add-to-cart" onclick="addToCart()">🛒 إضافة إلى عربة التسوق</button>
</div>

<div class="container admin-section">
<h2>لوحة تحكم المنتج</h2>
<label>اسم المنتج الرئيسي</label>
<input type="text" id="prodName">
<label>السعر الافتراضي</label>
<input type="text" id="prodPrice" oninput="formatPrice(this)">
<label>وصف المنتج</label>
<input type="text" id="prodDescInput">
<label>صورة المنتج</label>
<input type="file" id="prodImgFile" accept="image/*" onchange="uploadMainImage(event)">
<h3>خيارات المنتج</h3>
<div id="optionsList"></div>
<button onclick="addOption()">➕ إضافة خيار جديد</button>
<button onclick="saveData()">💾 حفظ التعديلات</button>
</div>

<script>
let productData = JSON.parse(localStorage.getItem("productData"))||{
name:"بلاط بناء مغناطيسي للأطفال",
description:"هذا هو وصف المنتج الثابت لجميع الخيارات.",
price:"6.89",
img:"https://via.placeholder.com/180",
options:[
{name:"طقم جونيور 32 قطعة",price:"6.89",img:"",stock:10},
{name:"طقم متوسط 60 قطعة",price:"11.50",img:"",stock:5},
{name:"طقم ممتاز 110 قطعة",price:"18.90",img:"",stock:2}
]
};

// ================= صفحة المنتج =================
function renderProduct(){
document.getElementById("productName").innerText=productData.name;
document.getElementById("productPrice").innerText=productData.price+" ر.ع";
document.getElementById("productDesc").innerText=productData.description;
document.getElementById("productImg").src=productData.img||"https://via.placeholder.com/180";
document.getElementById("productStock").innerText="المخزون: "+(productData.options[0].stock||0);

const container=document.getElementById("optionsContainer");
container.innerHTML="";
productData.options.forEach((opt,index)=>{
const span=document.createElement("span");
span.className="option-btn"+(index===0?" active":"");
span.innerText=opt.name;
span.onclick=()=>selectOption(index);
container.appendChild(span);
});
}

function selectOption(index){
document.querySelectorAll('.option-btn').forEach(btn=>btn.classList.remove('active'));
document.querySelectorAll('.option-btn')[index].classList.add('active');
let opt=productData.options[index];
document.getElementById("productPrice").innerText=(opt.price||productData.price)+" ر.ع";
document.getElementById("productImg").src=opt.img||productData.img;
document.getElementById("productStock").innerText="المخزون: "+(opt.stock||0);
}

function addToCart(){
alert("تمت إضافة المنتج: "+productData.name+"\n"+document.getElementById("productPrice").innerText+"\nالمخزون: "+document.getElementById("productStock").innerText.split(": ")[1]);
}

// ================= لوحة التحكم =================
function renderAdmin(){
document.getElementById("prodName").value=productData.name;
document.getElementById("prodPrice").value=productData.price;
document.getElementById("prodDescInput").value=productData.description;
const container=document.getElementById("optionsList");
container.innerHTML="";
productData.options.forEach((opt,index)=>{
const div=document.createElement("div");
div.className="option-item";
div.innerHTML=`
<input type="text" placeholder="اسم الخيار" value="${opt.name}" onchange="updateOptionName(${index}, this.value)">
<input type="text" placeholder="سعر الخيار" value="${opt.price}" oninput="formatOptionPrice(this, ${index})">
<input type="text" placeholder="المخزون" value="${opt.stock||0}" oninput="updateOptionStock(this.value, ${index})">
<label>صورة الخيار</label>
<input type="file" accept="image/*" onchange="uploadOptionImage(event, ${index})">
<button onclick="removeOption(${index})">🗑 حذف</button>
`;
container.appendChild(div);
});
}

function formatPrice(input){input.value=input.value.replace(/[^\d.]/g,'');}
function formatOptionPrice(input,index){input.value=input.value.replace(/[^\d.]/g,'');productData.options[index].price=input.value;}
function updateOptionStock(value,index){let num=value.replace(/[^\d]/g,'');productData.options[index].stock=parseInt(num)||0;}

function uploadMainImage(event){
const reader=new FileReader();
reader.onload=function(){productData.img=reader.result;document.getElementById("productImg").src=reader.result;};
reader.readAsDataURL(event.target.files[0]);
}

function uploadOptionImage(event,index){
const reader=new FileReader();
reader.onload=function(){productData.options[index].img=reader.result;renderProduct();};
reader.readAsDataURL(event.target.files[0]);
}

function addOption(){productData.options.push({name:"",price:"",img:"",stock:0});renderAdmin();}
function updateOptionName(index,value){productData.options[index].name=value;}
function removeOption(index){productData.options.splice(index,1);renderAdmin();}
function saveData(){productData.name=document.getElementById("prodName").value;productData.description=document.getElementById("prodDescInput").value;productData.price=document.getElementById("prodPrice").value;localStorage.setItem("productData",JSON.stringify(productData));alert("تم حفظ البيانات! ✅");renderProduct();}

renderProduct();renderAdmin();
</script>

</body>
</html>
